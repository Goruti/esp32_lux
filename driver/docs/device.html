

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Devices &mdash; SmartThings Edge Device Drivers  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="SmartThings Edge Device Drivers  documentation" href="index.html"/>
        <link rel="up" title="&lt;no title&gt;" href="reference/index.html"/>
        <link rel="next" title="Dispatchers" href="dispatchers.html"/>
        <link rel="prev" title="Capabilities" href="capabilities.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SmartThings Edge Device Drivers
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Guides:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guides/getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/first-driver.html">Writing your first Lua driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/package.html">Package Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/lan.html">LAN Edge Device Driver Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/rpc-client.html">Writing an RPC Client Driver</a></li>
</ul>
<p class="caption"><span class="caption-text">References:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lua_environment.html">Lua Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="log.html">Logging Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="buf.html">Buffer Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="zigbee/zigbee.html">Zigbee Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="zwave/zwave.html">Z-Wave Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="capabilities.html">Capabilities</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Devices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#device-class">Device Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#device-class-documentation">Device Class Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dispatchers.html">Dispatchers</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver_tests.html">Driver Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastore.html">Datastore</a></li>
<li class="toctree-l1"><a class="reference internal" href="socket.html">Socket Library</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SmartThings Edge Device Drivers</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="reference/index.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Devices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/device.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="devices">
<h1>Devices<a class="headerlink" href="#devices" title="Permalink to this headline">¶</a></h1>
<p>In order for a driver to do its job it will need to know information about the devices that it is responsible for.
Information about these devices is done through the “device_api” object that is provided in the environment.  There
are a few main ways to interact with this, but the most common will be the <code class="docutils literal notranslate"><span class="pre">get_device_list()</span></code> and
<code class="docutils literal notranslate"><span class="pre">get_device_info(&lt;device_uuid&gt;)</span></code> functions.  <code class="docutils literal notranslate"><span class="pre">get_device_list()</span></code> will return a list of UUIDs for all the devices that
are managed by the current driver. <code class="docutils literal notranslate"><span class="pre">get_device_info(&lt;device_uuid&gt;)</span></code> can be used directly, but it is recommended to use
the helper function <code class="docutils literal notranslate"><span class="pre">driver:get_device_info()</span></code>.  The primary reason for that is because this method will build a
<code class="docutils literal notranslate"><span class="pre">Device</span></code> object in lua that provides many utility functions and abstractions that will simplify many normal use cases
instead of providing a raw json string, .  It will also provide relevant caching and updating on changes
that originate outside the driver.  In addition a driver can provide a <code class="docutils literal notranslate"><span class="pre">post_device_info_handler</span></code> function that can do
additional processing after the provided processing.</p>
<p>Below is an example of what is returned using the <code class="docutils literal notranslate"><span class="pre">device_api.get_device_info(&lt;device_uuid&gt;)</span></code> function</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">driver</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;9fbc3680-b9a9-4bd8-a574-9b03517032b2&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;smartthings/Lua Zigbee Water&quot;</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;DATAMGMT&quot;</span> <span class="p">},</span>
  <span class="n">components</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">main</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">capabilities</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;temperatureMeasurement&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
        <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;battery&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
        <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;waterSensor&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
        <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;configuration&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
        <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;sensor&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
        <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;healthCheck&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="n">emit_event</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">capability_event</span><span class="p">,</span> <span class="n">event_metadata</span><span class="p">)</span> <span class="kr">end</span><span class="p">,</span>
      <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;main&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="n">preferences</span> <span class="o">=</span> <span class="p">{},</span>
  <span class="n">zigbee_endpoints</span> <span class="o">=</span> <span class="p">{</span>
     <span class="mi">1</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">client_clusters</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">25</span> <span class="p">},</span>
      <span class="n">device_id</span> <span class="o">=</span> <span class="mi">1026</span><span class="p">,</span>
      <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
      <span class="n">manufacturer</span> <span class="o">=</span> <span class="s2">&quot;CentraLite&quot;</span><span class="p">,</span>
      <span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;3315-S&quot;</span><span class="p">,</span>
      <span class="n">profile_id</span> <span class="o">=</span> <span class="mi">260</span><span class="p">,</span>
      <span class="n">server_clusters</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1026</span><span class="p">,</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">2821</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;02703834-4ab9-46e0-80ed-789fbd481f63&quot;</span><span class="p">,</span>
  <span class="n">fingerprinted_endpoint_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
  <span class="n">zigbee_eui</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x00\x0D\x6F\x00\x03\x26\x8A\x5C</span><span class="s2">&quot;</span><span class="p">,</span>
  <span class="n">network_type</span> <span class="o">=</span> <span class="s2">&quot;DEVICE_ZIGBEE&quot;</span><span class="p">,</span>
  <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Water Leak Sensor&quot;</span><span class="p">,</span>
  <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">deviceEUI</span> <span class="o">=</span> <span class="s2">&quot;000D6F0003268A5C&quot;</span><span class="p">,</span>
    <span class="n">firmwareChecked</span> <span class="o">=</span> <span class="s2">&quot;2020-01-15T00:41:46.213Z&quot;</span><span class="p">,</span>
    <span class="n">initialJoinTime</span> <span class="o">=</span> <span class="s2">&quot;2019-12-05T15:54:31.563Z&quot;</span><span class="p">,</span>
    <span class="n">initialJoinType</span> <span class="o">=</span> <span class="s2">&quot;Unsecure Join&quot;</span><span class="p">,</span>
    <span class="n">lastJoinTime</span> <span class="o">=</span> <span class="s2">&quot;2020-01-08T18:33:57.480Z&quot;</span><span class="p">,</span>
    <span class="n">lastJoinType</span> <span class="o">=</span> <span class="s2">&quot;Secure Rejoin&quot;</span><span class="p">,</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="s2">&quot;0000&quot;</span><span class="p">,</span>
    <span class="n">targetFirmwareVersion</span> <span class="o">=</span> <span class="s2">&quot;520573712&quot;</span><span class="p">,</span>
    <span class="n">zigbeeNodeType</span> <span class="o">=</span> <span class="s2">&quot;SLEEPY_END_DEVICE&quot;</span>
  <span class="p">},</span>
  <span class="n">execution_environment</span> <span class="o">=</span> <span class="s2">&quot;HUBCORE&quot;</span><span class="p">,</span>
  <span class="n">profile</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">{</span>
        <span class="n">capabilities</span> <span class="o">=</span> <span class="p">{</span>
          <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;temperatureMeasurement&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
          <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;battery&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
          <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;waterSensor&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
          <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;configuration&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
          <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;sensor&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">},</span>
          <span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;healthCheck&quot;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">}</span>
        <span class="p">},</span>
        <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;main&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="n">id</span> <span class="o">=</span> <span class="s2">&quot;b648f97a-ab00-4a92-a1f5-2d10bf9a5c7d&quot;</span>
  <span class="p">},</span>
  <span class="n">device_network_id</span> <span class="o">=</span> <span class="s2">&quot;D836&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="device-class">
<h2>Device Class<a class="headerlink" href="#device-class" title="Permalink to this headline">¶</a></h2>
<p>The device class is the wrapper on top of the raw data provided by the <code class="docutils literal notranslate"><span class="pre">device_api</span></code>.
The device class table will store information in a variety of different locations, and
these locations will be protected with metatables.  Following are the main pieces to the
device object.</p>
<dl class="simple">
<dt>st_store:</dt><dd><p>This is used to store the above shown representation of the SmartThings device
model.  It is read only, and will be updated automatically if there are changes in the
model from an external source (e.g. a change in the cloud).  The top level values of this
table are also “mirrored” onto the device object itself.  That is <code class="docutils literal notranslate"><span class="pre">device.st_store.id</span></code>
will give you the device’s UUID to refer to the device in the SmartThings platform, but you
can also access this value simply through <code class="docutils literal notranslate"><span class="pre">device.id</span></code>.  This is done for simplicity of
access.</p>
</dd>
<dt>transient_store:</dt><dd><p>The transient_store is used for storing driver/device specific information.
This information however, will only exist as long as the driver is running, and will need
to be re-populated where necessary on restart of the hub.  A good example of this would be
storing the timestamp of the last time you read a given attribute.  It’s something that is
only useful within the context of the specific driver, but is easily re-constructed after
a restart.  It is suggested that most of your data can/should be stored this way.  It is
also recommended that most user/driver stored data be accessed/set using the
<code class="docutils literal notranslate"><span class="pre">device:set_field</span></code> and <code class="docutils literal notranslate"><span class="pre">device:get_field</span></code> methods documented below.</p>
</dd>
<dt>persistent_store:</dt><dd><p>Similar to the transient_store, this is for use for driver specific
information, however, unlike the transient_store, information written here will be stored
and persisted through restarts.  This carries with it a cost in wear, as well as time delays
associated with the writing and reading.  This should also be accessed through the
<code class="docutils literal notranslate"><span class="pre">device:set_field</span></code> and <code class="docutils literal notranslate"><span class="pre">device:get_field</span></code> methods.  A good example of a target for the
persistent store would be something like the number of lock codes a lock can support.  This
is something that only needs to be read once when the device is first joined, and won’t
change for the lifetime of the device.  This could be read every time the driver restarts, but
it is reasonable to read once and store for the lifetime of the device.  In order to protect the
longevity of your hub device, we limit how frequently values are actually written to flash. This
does, however, come with a potential loss of information.  When the persistent store for your
driver is “written” it is cached in memory and will actually be written to flash on a schedule
and on graceful shutdown.  This means there is potential information loss in the case of a power
loss.</p>
</dd>
<dt>state_cache:</dt><dd><p>The state cache is a transient data cache that will keep track for each component,
capability, attribute, what the most recent generated state was.  So
<code class="docutils literal notranslate"><span class="pre">device.state_cache.main.switch</span></code> would contain <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">value</span> <span class="pre">=</span> <span class="pre">&quot;on&quot;</span> <span class="pre">}</span></code>.</p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">set_field</span></code> and <code class="docutils literal notranslate"><span class="pre">get_field</span></code> functions can be used to write and read from the persistent
and transient stores.  It is enforced that top level keys cannot be repeated between the two
stores, as such <code class="docutils literal notranslate"><span class="pre">get_field</span></code> will always return the single value with the matching key.
Consequently <code class="docutils literal notranslate"><span class="pre">set_field</span></code> will delete the value in the other store if it is written to the
other.</p>
<p>There are also a variety of other utility methods documented below.</p>
<div class="section" id="device-class-documentation">
<h3>Device Class Documentation<a class="headerlink" href="#device-class-documentation" title="Permalink to this headline">¶</a></h3>
<dl class="lua class">
<dt id="st.Device">
<em class="property">class </em><code class="sig-name descname">st.Device</code><a class="headerlink" href="#st.Device" title="Permalink to this definition">¶</a></dt>
<dd><p>A device object contains all of the information we have about a given device that is set to be managed by this
driver.  It also provides a number of utility functions that make normal operations for dealing with devices
simpler.</p>
<dl class="lua attribute">
<dt id="st.Device.transient_store">
<code class="sig-name descname">transient_store</code><em class="property">: </em>table<a class="headerlink" href="#st.Device.transient_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to store driver specific data about a device that will not persist through driver restart.</p>
</dd></dl>

<dl class="lua attribute">
<dt id="st.Device.persistent_store">
<code class="sig-name descname">persistent_store</code><em class="property">: </em>table<a class="headerlink" href="#st.Device.persistent_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to store driver specific data about a device that will be persisted through restart.  The actual flash writes are on a schedule so some data loss is possible if the hub experiences a power loss</p>
</dd></dl>

<dl class="lua attribute">
<dt id="st.Device.st_store">
<code class="sig-name descname">st_store</code><em class="property">: </em>table<a class="headerlink" href="#st.Device.st_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the SmartThings device model.  Read only and can be updated as a result of changes made elsewhere in the system.</p>
</dd></dl>

<dl class="lua attribute">
<dt id="st.Device.state_cache">
<code class="sig-name descname">state_cache</code><em class="property">: </em>table<a class="headerlink" href="#st.Device.state_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Caches the most recent event state generated for each component/capability/attribute this is per run session, and is not persisted through restart.</p>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.emit_event">
<em class="property"> </em><code class="sig-name descname">emit_event</code><span class="sig-paren">(</span><em class="sig-param">capability_event</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.emit_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit a capability event for this devices main component.  Will log a warning and do nothing if there is no “main” component on the device</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>capability_event</strong> (<em>table</em>) – the capability event to emit</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.emit_component_event">
<em class="property"> </em><code class="sig-name descname">emit_component_event</code><span class="sig-paren">(</span><em class="sig-param">component</em>, <em class="sig-param">capability_event</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.emit_component_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a capability event for this device and component</p>
<p>Usage: <code class="docutils literal notranslate"><span class="pre">device:emit_component_event(device.components.main,</span> <span class="pre">capabilities.switch.switch.on())</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> (<em>table</em>) – The component to generate this event for</p></li>
<li><p><strong>capability_event</strong> (<em>table</em>) – The event table generated from a capability</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The converted SmartThings event generated by this device</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>table</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.set_field">
<em class="property"> </em><code class="sig-name descname">set_field</code><span class="sig-paren">(</span><em class="sig-param">field</em>, <em class="sig-param">value</em>, <em class="sig-param">addtional_params</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.set_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a device specific value to be stored and retrieved when needed.  The key names are unique across both persistent and transient stores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>str</em>) – The field name for this value</p></li>
<li><p><strong>value</strong> (<em>value</em>) – The value to set the field to. If setting to persistent store it must be serializable</p></li>
<li><p><strong>addtional_params</strong> (<em>table</em>) – Optional: contains additional description of the field.  Currently only usage is the <cite>persist</cite> field which, if true, will store the field to the persistent store instead of transient</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.get_field">
<em class="property"> </em><code class="sig-name descname">get_field</code><span class="sig-paren">(</span><em class="sig-param">field</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.get_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the value a previously set field.  nil if non-existent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>field</strong> (<em>str</em>) – The field name for this value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value The value the field was set to.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>value</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.supports_capability">
<em class="property"> </em><code class="sig-name descname">supports_capability</code><span class="sig-paren">(</span><em class="sig-param">capability</em>, <em class="sig-param">component</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.supports_capability" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this device has a capability in its profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>capability</strong> (<em>Capability</em>) – The capability to check for existence</p></li>
<li><p><strong>component</strong> (<em>str</em>) – Optional: The component id to check for capability support.  If nil, any component match will return true</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>true if the capability is present in this devices profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.component_exists">
<em class="property"> </em><code class="sig-name descname">component_exists</code><span class="sig-paren">(</span><em class="sig-param">component_id</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.component_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this device has a component_id in its profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>component_id</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>true if the component is present in this devices profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.get_latest_state">
<em class="property"> </em><code class="sig-name descname">get_latest_state</code><span class="sig-paren">(</span><em class="sig-param">component_id</em>, <em class="sig-param">capability_id</em>, <em class="sig-param">attribute_name</em>, <em class="sig-param">default_value</em>, <em class="sig-param">default_state_table</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.get_latest_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the latest state of this device for a given component, capability, attribute</p>
<p>table (e.g. it would include both the value and unit keys if both are present)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component_id</strong> (<em>str</em>) – the component ID to get the state for</p></li>
<li><p><strong>capability_id</strong> (<em>str</em>) – the capability ID to get the state for</p></li>
<li><p><strong>attribute_name</strong> (<em>str</em>) – the capability attribute name to get the state for</p></li>
<li><p><strong>default_value</strong> (<em>any</em>) – Optional value to return if the state_cache for the lookup is nil</p></li>
<li><p><strong>default_state_table</strong> (<em>any</em>) – Optional value to return if the state_cache for the lookup is nil</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The first return value is the state.value present for the attribute, the second return is the state</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>any or any</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.component_count">
<em class="property"> </em><code class="sig-name descname">component_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.component_count" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>count of components in device profile</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.supports_capability_by_id">
<em class="property"> </em><code class="sig-name descname">supports_capability_by_id</code><span class="sig-paren">(</span><em class="sig-param">capability_id</em>, <em class="sig-param">component</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.supports_capability_by_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this device has a capability_id in its profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>capability_id</strong> (<em>str</em>) – The capability ID to check for existence</p></li>
<li><p><strong>component</strong> (<em>str</em>) – Optional: The component id to check for capability support.  If nil, any component match will return true</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>true if the capability is present in this devices profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.try_update_metadata">
<em class="property"> </em><code class="sig-name descname">try_update_metadata</code><span class="sig-paren">(</span><em class="sig-param">metadata</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.try_update_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a request to update the metadata of a device.</p>
<p>Example usage: <code class="docutils literal notranslate"><span class="pre">device:try_update_metadata({profile</span> <span class="pre">=</span> <span class="pre">&quot;bulb.rgb.v1&quot;,</span> <span class="pre">vendor_provided_label</span> <span class="pre">=</span> <span class="pre">&quot;My</span> <span class="pre">RGB</span> <span class="pre">Bulb&quot;})</span></code></p>
<p>All metadata fields are type string. Valid metadata fields are:</p>
<p>For all network types (LAN/ZIGBEE/ZWAVE):
profile - profile name defined in the profile .yaml file.
provisioning_state - the provisioning state of the device (TYPED/PROVISIONED)</p>
<p>LAN specific:
manufacturer - device manufacturer
model - model name of the device
vendor_provided_label - device label provided by the manufacturer/vendor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metadata</strong> (<em>table</em>) – A table of device metadata</p>
</dd>
</dl>
</dd></dl>

<dl class="lua staticmethod">
<dt id="st.Device.build">
<em class="property">static </em><code class="sig-name descname">build</code><span class="sig-paren">(</span><em class="sig-param">cls</em>, <em class="sig-param">driver</em>, <em class="sig-param">raw_device</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a device object from a raw st_store of the SmartThings device model</p>
<p>helper event generation functions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<em>table</em>) – The Device class</p></li>
<li><p><strong>driver</strong> (<a class="reference internal" href="drivers.html#Driver" title="Driver"><em>Driver</em></a>) – The driver context this device will run under</p></li>
<li><p><strong>raw_device</strong> (<em>table</em>) – The SmartThings device model representation, used to populate the st_store and generate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The created device</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Device</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.load_updated_data">
<em class="property"> </em><code class="sig-name descname">load_updated_data</code><span class="sig-paren">(</span><em class="sig-param">new_device_data</em><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.load_updated_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the st_store data with newly provided data from the cloud.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_device_data</strong> (<em>any</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.deleted">
<em class="property"> </em><code class="sig-name descname">deleted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>This will do any necessary cleanup if the device is removed.  The device object will not</p>
<p>be functional after this call.</p>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.pretty_print">
<em class="property"> </em><code class="sig-name descname">pretty_print</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.pretty_print" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a string with the ID and label of the device</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a short string representation of the device</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.online">
<em class="property"> </em><code class="sig-name descname">online</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.online" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark device as being online</p>
<p>Only useable on LAN type devices, calls to this API for ZIGBEE or ZWAVE type devices are
ignored as their online/offline status are automatically determined at the radio level.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>boolean Status of whether the call was successful or not</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>status</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string The error that occured if status was falsey</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>error</p>
</dd>
</dl>
</dd></dl>

<dl class="lua method">
<dt id="st.Device.offline">
<em class="property"> </em><code class="sig-name descname">offline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#st.Device.offline" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark device as being offline and unavailable</p>
<p>Only useable on LAN type devices, calls to this API for ZIGBEE or ZWAVE type devices are
ignored as their online/offline status are automatically determined at the radio level.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>boolean Status of whether the call was successful or not</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>status</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string The error that occured if status was falsey</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>error</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dispatchers.html" class="btn btn-neutral float-right" title="Dispatchers" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="capabilities.html" class="btn btn-neutral" title="Capabilities" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, SmartThings Developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ❤️  using a custom <a href="https://github.com/LinxiFan/Sphinx-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>